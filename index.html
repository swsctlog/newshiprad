<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞—à–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Bootstrap 5 –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* –ù–µ–±–æ–ª—å—à–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –≤–∏–¥–∞ */
        body {
            background-color: #f0f2f5;
        }
        .info-card {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: none;
            border-radius: 12px;
        }
        .list-group-item {
            background-color: #fff;
            border-bottom: 1px solid #f0f0f0;
        }
        .list-group-item:last-child {
            border-bottom: none;
        }
        .label {
            font-weight: 600;
            color: #555;
        }
        .value {
            color: #000;
            word-break: break-all; /* –î–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫, –∫–∞–∫ User-Agent */
        }
        .vpn-yes {
            color: #dc3545; /* –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –¥–ª—è –∞–∫—Ü–µ–Ω—Ç–∞ */
            font-weight: bold;
        }
        .vpn-no {
            color: #198754; /* –ó–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç */
            font-weight: bold;
        }
        .spinner-border {
            width: 1.2rem;
            height: 1.2rem;
        }
    </style>
</head>
<body>
    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-7">
                <div class="card info-card">
                    <div class="card-header bg-primary text-white text-center">
                        <h4 class="mb-0">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∞—à–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏</h4>
                    </div>
                    <ul class="list-group list-group-flush">
                        <!-- IP –ê–¥—Ä–µ—Å -->
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span class="label">üåç IP-–∞–¥—Ä–µ—Å:</span>
                            <span class="value" id="ip-address">
                                <div class="spinner-border text-primary" role="status"></div>
                            </span>
                        </li>
                        <!-- –°—Ç–∞—Ç—É—Å VPN/–ü—Ä–æ–∫—Å–∏ -->
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span class="label">üõ°Ô∏è VPN/–ü—Ä–æ–∫—Å–∏:</span>
                            <span class="value" id="vpn-status">
                                <div class="spinner-border text-primary" role="status"></div>
                            </span>
                        </li>
                        <!-- –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ -->
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span class="label">üìç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</span>
                            <span class="value" id="location">
                                <div class="spinner-border text-primary" role="status"></div>
                            </span>
                        </li>
                        <!-- –ü—Ä–æ–≤–∞–π–¥–µ—Ä -->
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span class="label">üì° –ü—Ä–æ–≤–∞–π–¥–µ—Ä (ISP):</span>
                            <span class="value" id="isp">
                                <div class="spinner-border text-primary" role="status"></div>
                            </span>
                        </li>
                        <!-- –í—Ä–µ–º—è –ø–æ—Å–µ—â–µ–Ω–∏—è -->
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span class="label">‚è∞ –í—Ä–µ–º—è –ø–æ—Å–µ—â–µ–Ω–∏—è:</span>
                            <span class="value" id="visit-time"></span>
                        </li>
                        <!-- –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å -->
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span class="label">‚è≥ –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:</span>
                            <span class="value" id="timezone"></span>
                        </li>
                        <!-- –ë—Ä–∞—É–∑–µ—Ä –∏ –û–° -->
                        <li class="list-group-item d-flex flex-column align-items-start">
                            <span class="label mb-1">üíª –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ –±—Ä–∞—É–∑–µ—Ä:</span>
                            <span class="value" id="user-agent"></span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ HTML
        function displayData(id, value, className) {
            const element = document.getElementById(id);
            if (element) {
                const spinner = element.querySelector('.spinner-border');
                if(spinner) spinner.remove();
                element.textContent = value;
                if(className) {
                    element.classList.add(className);
                }
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Å–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        async function fetchAndDisplayInfo() {
            // 1. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
            const visitTime = new Date().toLocaleString('ru-RU', { dateStyle: 'long', timeStyle: 'medium' });
            const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const userAgent = navigator.userAgent;

            displayData('visit-time', visitTime);
            displayData('timezone', timeZone);
            displayData('user-agent', userAgent);

            // 2. –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ –≤–Ω–µ—à–Ω–µ–º—É API ipwho.is
            try {
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º CORS-–ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤ —Å—Ä–µ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
                const apiUrl = 'https://api.allorigins.win/raw?url=https://ipwho.is/';
                const response = await fetch(apiUrl);
                // –û—Ç–≤–µ—Ç –æ—Ç –ø—Ä–æ–∫—Å–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–∞–∫ —Ç–µ–∫—Å—Ç, –µ–≥–æ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ JSON
                const data = JSON.parse(await response.text());

                if (data.success) {
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç
                    displayData('ip-address', data.ip);
                    displayData('location', `${data.country}, ${data.city}`);
                    displayData('isp', data.connection.isp);

                    // –ò–°–ü–†–ê–í–õ–ï–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ data.security
                    const isVpn = data.security && (data.security.vpn || data.security.proxy || data.security.tor);
                    if (isVpn) {
                        displayData('vpn-status', '–î–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è', 'vpn-yes');
                    } else {
                        displayData('vpn-status', '–ù–µ—Ç', 'vpn-no');
                    }

                } else {
                    throw new Error(data.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ IP');
                }
                
            } catch (error) {
                console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö IP:", error);
                const errorMessage = '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å';
                displayData('ip-address', errorMessage);
                displayData('location', errorMessage);
                displayData('isp', errorMessage);
                displayData('vpn-status', errorMessage);
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = fetchAndDisplayInfo;
    </script>
</body>
</html>
