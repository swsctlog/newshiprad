<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Голосовой Ассистент</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .container {
            margin-top: 50px;
        }
        .status {
            font-size: 1.5rem;
            font-weight: bold;
            color: #007bff;
        }
    </style>
</head>
<body>
    <div class="container text-center">
        <h1 class="mb-4">Голосовой Ассистент</h1>
        <p class="status" id="status">Подключение...</p>
        <div class="alert alert-info mt-4" id="output">
            Ожидаю команду...
        </div>
        <div class="mt-5">
            <button class="btn btn-primary" id="startButton">Запустить распознавание</button>
        </div>
    </div>

    <script>
        // Проверяем поддержку SpeechRecognition
        if (!('SpeechRecognition' in window || 'webkitSpeechRecognition' in window)) {
            alert('Ваш браузер не поддерживает SpeechRecognition. Попробуйте Google Chrome.');
        } else {
            // Ключевые слова
            const keywords = ['открой сайт', 'ключевое слово', 'браузер'];

            // Инициализация SpeechRecognition
            const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.lang = 'ru-RU';
            recognition.interimResults = false;
            recognition.continuous = true;

            const statusElement = document.getElementById('status');
            const outputElement = document.getElementById('output');
            const startButton = document.getElementById('startButton');

            async function startRecognition() {
    try {
        // Проверяем доступ к микрофону
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        stream.getTracks().forEach(track => track.stop()); // Останавливаем поток, так как он нужен только для проверки
        recognition.start();
        statusElement.textContent = 'Слушаю...';
        statusElement.style.color = '#007bff';
    } catch (error) {
        statusElement.textContent = 'Ошибка доступа к микрофону!';
        statusElement.style.color = 'red';
        console.error('Ошибка доступа к микрофону:', error);
    }
}


            // Обработчик распознанной речи
            recognition.onresult = (event) => {
                const transcript = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();
                outputElement.textContent = `Распознанный текст: ${transcript}`;

                // Проверка на ключевые слова
                for (let keyword of keywords) {
                    if (transcript.includes(keyword)) {
                        statusElement.textContent = 'Ключевое слово найдено!';
                        statusElement.style.color = 'green';
                        window.open('https://example.com', '_blank'); // Открывает сайт
                        return;
                    }
                }

                statusElement.textContent = 'Ожидаю команду...';
                statusElement.style.color = '#007bff';
            };

            // Обработчик ошибок
            recognition.onerror = (event) => {
                outputElement.textContent = `Ошибка распознавания: ${event.error}`;
                statusElement.textContent = 'Ошибка! Проверьте настройки.';
                statusElement.style.color = 'red';
            };

            // Перезапуск при остановке
            recognition.onend = () => {
                statusElement.textContent = 'Прослушивание остановлено. Нажмите снова, чтобы начать.';
                statusElement.style.color = 'red';
            };

            // Запуск распознавания речи
            startButton.addEventListener('click', () => {
                try {
                    recognition.start();
                    statusElement.textContent = 'Слушаю...';
                    statusElement.style.color = '#007bff';
                } catch (error) {
                    outputElement.textContent = `Ошибка запуска: ${error.message}`;
                    statusElement.style.color = 'red';
                }
            });
        }
    </script>
</body>
</html>
